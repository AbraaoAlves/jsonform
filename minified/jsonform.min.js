/* jsonform.js */
(function(l){l.fn.extend({jsonform:function(c,e){var a={},f=function(b){a=b};typeof c==="function"?(f=c,c=null):a=c;typeof c==="object"&&typeof e==="function"&&(f=e);this.populate(a);f(this.getJSON());return this},getJSON:function(c){var e={},a=this;a.find("input,textarea,select").each(function(f,b){c?a.merge(e,a.buildJson(b.name,b.value)):a.merge(e,a.buildJson(b.id,b.value))});return e},buildJson:function(c,e){for(var a=c.split("."),f={},b=a.length;b>0;b--){var j={},d=a[b-1];if(d==a[a.length-1])j[d]=
e;else{var g=d.search(/\[(\d+)\]/);if(g>-1){for(var h=d.substring(0,g),d=d.substring(g+1,d.indexOf("]")),h=j[h]=[],g=0;g<d;g++)h[g]={};h[d]=f}else j[d]=f}f=j}return f},populate:function(c,e){var a=this;(function b(c,d){for(var g in c)if(c[g]){var h=c[g];if(typeof h=="object"){var i=!d?g:d+"\\."+g;if(l.isArray(h))for(var k in h)h[k]&&(parent_arr=i+"\\["+k+"\\]",b(h[k],parent_arr));else b(h,i)}else i=d?"#"+d+"\\."+g:"#"+g,e&&(i=i.replace("#","[name='")+"']"),a.find(i).val(h)}})(c);return this},merge:function e(a,
f){for(var b in f)typeof f[b]==="object"&&typeof a[b]!=="undefined"?e(a[b],f[b]):a[b]=f[b];return a},clone:function(e){return this.merge({},e)}})})(jQuery);