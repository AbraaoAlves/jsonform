/* jsonform.js */
(function(j){j.fn.extend({version:"1.0.0",getJSON:function(f){var h={},b=this;b.find("input,textarea,select").each(function(i,a){var g=f?j.trim(a.id):j.trim(a.name);g!==""&&b.merge(h,b.buildJson(g,a.value))});return h},populate:function(f,h){var b=this;(function a(g,c){for(var d in g)if(g[d]){var e=g[d];if(typeof e=="object"){var f=!c?d:c+"\\."+d;if(j.isArray(e))for(var k in e)e[k]&&(parent_arr=f+"\\["+k+"\\]",a(e[k],parent_arr));else a(e,f)}else{var f=c?c+"\\."+d:d,l="[name='"+f+"']";h&&(l="#"+f);
b.find(l).val(e)}}})(f);return this},buildJson:function(f,h){for(var b=f.split("."),i={},a=b.length;a>0;a--){var g={},c=b[a-1];if(c==b[b.length-1])g[c]=h;else{var d=c.search(/\[(\d+)\]/);if(d>-1){for(var e=c.substring(0,d),c=c.substring(d+1,c.indexOf("]")),e=g[e]=[],d=0;d<c;d++)e[d]={};e[c]=i}else g[c]=i}i=g}return i},merge:function h(b,i){for(var a in i)typeof i[a]==="object"&&typeof b[a]!=="undefined"?h(b[a],i[a]):b[a]=i[a];return b},clone:function(h){return this.merge({},h)}})})(jQuery);